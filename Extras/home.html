<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MOM - Postpartum Care Companion</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="index.css" />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      /* Override dropdown styles */
      #profileDropdown {
        position: fixed !important;
        display: none;
        z-index: 9999 !important;
        background: white !important;
        border-radius: 10px !important;
        box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2) !important;
        padding: 15px !important;
        width: 300px !important;
        right: 25px !important;
        top: 65px !important;
      }

      #profileSection {
        position: relative;
        z-index: 9999;
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header>
      <div class="header-container">
        <div class="logo">
          <div class="logo-icon">
            <i class="fas fa-heart"></i>
          </div>
          <div class="logo-text">MOM</div>
        </div>
        <ul class="nav-links" style="margin-left: auto; margin-right: 20px">
          <li><a href="./home.html">Home</a></li>
        </ul>
        <!-- Auth Section -->
        <div
          class="auth-section"
          style="
            display: flex;
            align-items: center;
            margin-left: 20px;
            position: relative;
            z-index: 1000;
          "
        >
          <!-- Login/Signup buttons (shown by default) -->
          <div
            class="auth-buttons"
            id="authButtons"
            style="display: flex; gap: 10px"
          >
            <a
              href="./login.html"
              class="auth-button"
              style="
                padding: 8px 15px;
                background: #ff7eb9;
                color: white;
                text-decoration: none;
                border-radius: 5px;
                font-weight: 500;
              "
              >Login</a
            >
            <a
              href="./signup.html"
              class="auth-button"
              style="
                padding: 8px 15px;
                background: white;
                color: #ff7eb9;
                text-decoration: none;
                border-radius: 5px;
                border: 2px solid #ff7eb9;
                font-weight: 500;
              "
              >Sign Up</a
            >
          </div>
          <!-- Profile section (hidden by default, shown after auth) -->
          <div
            class="profile-section"
            id="profileSection"
            style="display: none; align-items: center"
          >
            <div
              class="user-greeting"
              style="margin: 0 10px; color: #ff7eb9; font-weight: bold"
            >
              Hello, <span id="userNameDisplay">User</span>
            </div>
            <div
              class="profile-icon"
              style="cursor: pointer; font-size: 1.5rem; color: #ff7eb9"
              onclick="toggleProfileDropdown()"
            >
              <i class="fas fa-user-circle"></i>
            </div>
          </div>
          <div
            id="profileDropdown"
            style="
              z-index: 9999;
              position: fixed;
              display: none;
              background: white;
              border-radius: 10px;
              box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
              padding: 15px;
              width: 200px;
              right: 25px;
              top: 65px;
            "
          >
            <a
              href="#"
              onclick="handleLogout()"
              style="
                display: block;
                padding: 12px 15px;
                color: #333;
                text-decoration: none;
                border-radius: 5px;
                transition: all 0.3s ease;
              "
              onmouseover="this.style.backgroundColor='#f8f8f8'"
              onmouseout="this.style.backgroundColor='transparent'"
            >
              <i class="fas fa-sign-out-alt" style="margin-right: 8px"></i>
              Logout
            </a>
          </div>
        </div>
      </div>
      <div class="header-bubbles" id="header-bubbles"></div>
    </header>

    <!-- Main Content -->
    <main>
      <section class="welcome-section">
        <h1>Your Personal Postpartum Care Assistant</h1>
        <p>
          Get expert guidance, emotional support, and practical advice during
          your postpartum journey. Our AI assistant is here to help you navigate
          this precious time with confidence and joy.
        </p>
      </section>

      <!-- Chatbot Container -->
      <div class="chatbot-container">
        <div class="chatbot-header">
          <div class="chatbot-icon">
            <i class="fas fa-baby"></i>
            <span class="chatbot-status"></span>
          </div>
          <div class="chatbot-title">
            <h2>MOMCare Assistant</h2>
            <p>Ask me anything about your postpartum care</p>
          </div>
          <svg
            class="wave"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 1440 320"
          >
            <path
              class="wave-path"
              d="M0,224L40,213.3C80,203,160,181,240,181.3C320,181,400,203,480,224C560,245,640,267,720,261.3C800,256,880,224,960,213.3C1040,203,1120,213,1200,229.3C1280,245,1360,267,1400,277.3L1440,288L1440,320L1400,320C1360,320,1280,320,1200,320C1120,320,1040,320,960,320C880,320,800,320,720,320C640,320,560,320,480,320C400,320,320,320,240,320C160,320,80,320,40,320L0,320Z"
            ></path>
          </svg>
        </div>
        <div class="chatbot-messages" id="chatMessages">
          <div class="message bot-message">
            Hello there! I'm your MOMCare Assistant. How can I help with your
            postpartum journey today?
            <div class="message-time">Just now</div>
          </div>
          <div class="typing-indicator" id="typingIndicator">
            <span class="typing-dot"></span>
            <span class="typing-dot"></span>
            <span class="typing-dot"></span>
          </div>
        </div>
        <div class="chatbot-input">
          <input
            type="text"
            id="userInput"
            placeholder="Type your question here..."
            aria-label="Type your message"
          />
          <button class="send-btn" id="sendButton" aria-label="Send message">
            <i class="fas fa-paper-plane"></i>
          </button>
        </div>
      </div>

      <!-- Feature Cards -->
      <div class="feature-cards">
        <div class="feature-card">
          <div class="feature-icon">
            <i class="fas fa-stethoscope"></i>
          </div>
          <h3>Expert Care Guidance</h3>
          <p>
            Get evidence-based information about physical recovery,
            breastfeeding, baby care, and more to support your postpartum
            health.
          </p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">
            <i class="fas fa-heart"></i>
          </div>
          <h3>Emotional Support</h3>
          <p>
            Find compassionate guidance for navigating the emotional changes and
            challenges that come with the postpartum period.
          </p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">
            <i class="fas fa-calendar-check"></i>
          </div>
          <h3>Self-Care Reminders</h3>
          <p>
            Receive personalized reminders and practical tips to help you
            prioritize self-care during this important transition period.
          </p>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer>
      <div class="footer-bg">
        <svg
          class="footer-wave"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 1440 320"
        >
          <path
            d="M0,64L48,80C96,96,192,128,288,149.3C384,171,480,181,576,165.3C672,149,768,107,864,85.3C960,64,1056,64,1152,80C1248,96,1344,128,1392,144L1440,160L1440,0L1392,0C1344,0,1248,0,1152,0C1056,0,960,0,864,0C768,0,672,0,576,0C480,0,384,0,288,0C192,0,96,0,48,0L0,0Z"
          ></path>
        </svg>
      </div>
      <div class="footer-content">
        <div class="footer-about">
          <h3>MOM</h3>
          <p>
            We're dedicated to supporting new parents through their postpartum
            journey with compassion, evidence-based information, and
            personalized guidance.
          </p>
          <div class="social-links">
            <a href="#" class="social-link" aria-label="Facebook"
              ><i class="fab fa-facebook-f"></i
            ></a>
            <a href="#" class="social-link" aria-label="Twitter"
              ><i class="fab fa-twitter"></i
            ></a>
            <a href="#" class="social-link" aria-label="Instagram"
              ><i class="fab fa-instagram"></i
            ></a>
            <a href="#" class="social-link" aria-label="Pinterest"
              ><i class="fab fa-pinterest-p"></i
            ></a>
          </div>
        </div>
        <div class="footer-newsletter">
          <h4>Stay Updated</h4>
          <p>
            Subscribe to our newsletter to receive the latest postpartum care
            tips and resources.
          </p>
          <form class="newsletter-form">
            <input
              type="email"
              placeholder="Your email address"
              aria-label="Email for newsletter"
            />
            <button type="submit" class="newsletter-btn">Subscribe</button>
          </form>
        </div>
        <div class="footer-bottom">
          <p>
            &copy; 2025 MOM - Your Postpartum Care Companion. All rights
            reserved. Designed with
            <i class="fas fa-heart" style="color: var(--primary)"></i> for new
            parents.
          </p>
        </div>
      </div>
    </footer>

    <!-- JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="/js/api.js"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/chatbot.js"></script>
    <script>
      // Toggle profile dropdown
      function toggleProfileDropdown() {
        const dropdown = document.getElementById("profileDropdown");
        if (dropdown.style.display === "block") {
          dropdown.style.display = "none";
        } else {
          dropdown.style.display = "block";
          // Ensure dropdown is positioned properly
          const icon = document.querySelector(".profile-icon");
          if (icon) {
            const rect = icon.getBoundingClientRect();
            dropdown.style.top = rect.bottom + 10 + "px";
            dropdown.style.right = window.innerWidth - rect.right + 5 + "px";
          }
        }
      }

      // Handle logout
      function handleLogout() {
        localStorage.removeItem("token");
        localStorage.removeItem("user");
        window.location.href = "/login.html";
      }

      // Update UI based on auth state
      function updateAuthUI() {
        const token = localStorage.getItem("token");
        const user = JSON.parse(localStorage.getItem("user") || "{}");
        const authButtons = document.getElementById("authButtons");
        const profileSection = document.getElementById("profileSection");
        const userNameDisplay = document.getElementById("userNameDisplay");

        if (token) {
          // User is authenticated
          authButtons.style.display = "none";
          profileSection.style.display = "flex";
          userNameDisplay.textContent = user.name || "User";
        } else {
          // User is not authenticated
          authButtons.style.display = "flex";
          profileSection.style.display = "none";
        }
      }

      document.addEventListener("DOMContentLoaded", function () {
        // Initialize auth UI
        updateAuthUI();

        // Create header bubbles
        createBubbles();

        // Initialize chat functionality
        initChat();

        // Close dropdown when clicking outside
        document.addEventListener("click", function (e) {
          const profileDropdown = document.getElementById("profileDropdown");
          const profileIcon = document.querySelector(".profile-icon");

          if (
            profileDropdown &&
            profileIcon &&
            !profileIcon.contains(e.target) &&
            !profileDropdown.contains(e.target) &&
            profileDropdown.style.display === "block"
          ) {
            profileDropdown.style.display = "none";
          }
        });
      });

      // Create header bubbles
      function createBubbles() {
        const headerBubbles = document.querySelector(".header-bubbles");
        if (!headerBubbles) return;

        for (let i = 0; i < 10; i++) {
          const bubble = document.createElement("div");
          bubble.classList.add("bubble");
          const size = Math.random() * 30 + 15;
          bubble.style.width = `${size}px`;
          bubble.style.height = `${size}px`;
          bubble.style.left = `${Math.random() * 100}%`;
          bubble.style.animationDuration = `${Math.random() * 10 + 10}s`;
          bubble.style.animationDelay = `${Math.random() * 5}s`;
          headerBubbles.appendChild(bubble);
        }
      }
    </script>
  </body>
</html>
